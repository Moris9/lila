.board-editor {

  $board-width: calc(96vh * var(--board-scale) * 0.8 - #{$site-header-height});

  display: grid;

  grid-template-columns: minmax(0, $board-width);
  grid-template-areas:
  'spare-top'
  'board'
  'spare-bottom'
  'tools'
  'copyables';

  @include breakpoint($mq-x-small) {
    grid-template-columns: auto minmax(30vmin, $board-width) 2vmin minmax(200px, 300px) auto;
    grid-template-rows: min-content auto min-content;
    grid-template-areas:
    '. .            . tools .'
    '. spare-top    . tools .'
    '. board        . tools .'
    '. spare-bottom . tools .'
    '. .            . tools .'
    '. copyables    . .     .';
  }

  user-select: none;

  & .spare {
    @extend %box-radius;
    display: flex;
    background: $c-font-dimmer;
    box-shadow: 0 3px 5px rgba(0,0,0,0.3) inset;
    &-top {
      grid-area: spare-top;
      margin-bottom: 2vh;
    }
    &-bottom {
      grid-area: spare-bottom;
      margin-top: 2vh;
    }
    & .no-square {
      flex: 0 0 12.5%;
      transition: 0.15s;
      &:hover {
        background: fade-out($c-primary, .8);
      }
      &:first-child {
        @extend %box-radius-left;
      }
      &:last-child {
        @extend %box-radius-right;
      }
      &.selected-square {
        background: fade-out($c-primary, .5);
      }
      & div {
        @extend %square;
        position: relative;
      }
    }
    .is3d & .no-square {
      height: 58.102px;
    }
    & piece {
      display: block;
      cursor: pointer;
      width: 100%;
      height: 100%;
    }
    .is3d & piece {
      /* original size:
      width: 140.625%;
      height: 179.6875%; */
  /* size on 3D board, with height/width = 90.78571% */
  width: 100%;
  height: 140.7465%;
  left: 0;
  top: -36%;
}
& piece.pointer {
  background-image: img-url('icons/pointer.png');
}
& piece.trash {
  background-image: img-url('icons/trash.png');
}
& .no-square.trash {
  color: black;
  text-align: center
}
.is3d & piece.pointer,
.is3d & piece.trash {
  top: -15%;
}
  }

  & .cg-board-wrap {
    grid-area: board;
  }
  & .cg-board {
    cursor: inherit;
  }

  &__tools {
    @extend %flex-column;
    grid-area: tools;
    align-self: center;
    & > * {
      margin: .5rem 0;
    }
    & select {
      width: 100%;
      &.positions option:checked {
        font-style: italic;
      }
    }
    & .metadata {
      @extend %box-neat;
      background: $c-bg-box;
      padding: 1rem;
      white-space: nowrap;
      & .color {
        margin-bottom: 1em;
      }
      & .castling {
        & div {
          @extend %flex-between;
        }
        & label,
        & input {
          display:inline-block;
          margin: 3px;
          vertical-align: middle;
        }
      }
    }
    & .actions {
      @extend %flex-column;
      justify-content: stretch;
      & .button {
        width: 100%;
        text-align: left;
      }
    }
  }

  & .copyables {
    grid-area: copyables;
    margin: 2rem 0 0 1rem;
    & p {
      display: flex;
      align-items: center;
      & input {
        margin-left: 1rem;
        flex: 1 1 100%;
      }
    }
  }
}

.continue_with {
  display: none;
  & div {
    @extend %flex-column;
  }
}

// .is3d #board_editor .spare piece.pointer, .is3d #board_editor .spare piece.trash {
//   top: -15%;
// }
