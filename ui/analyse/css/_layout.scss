body {
  /* prevents scroll bar flicker on page height changes */
  overflow-y: scroll;
}

#main-wrap {
  --main-max-width: calc(100vh - #{$site-header-outer-height} - #{$col1-uniboard-controls});
  @include breakpoint($mq-col2) {
    --main-max-width: auto;
  }
}

.analyse {
  grid-area: main;
  display: grid;

  &__side {
    grid-area: side;
    justify-content: start;
  }
  &__board { grid-area: board; }
  &__tools { grid-area: tools; }
  &__controls { grid-area: controls; }
  &__underboard {
    grid-area: under;
    overflow: hidden; // helps truncating long study names
  }
  &__acpl { grid-area: acpl; }
  .chat__members { grid-area: uchat; }
  .eval-gauge {
    grid-area: gauge;
    display: none;
  }

  --meta-height: 8em;
  @include proper-grid {
    --meta-height: max-content;
  }

  grid-template-rows: auto auto 50vh;
  grid-template-areas:
  'board'
  'controls'
  'tools'
  'side'
  'acpl'
  'under'
  'chat'
  'uchat';

  grid-row-gap: $block-gap;

  --gauge-width: 0px;
  &.gauge-on {
    --gauge-width: #{$gauge-on-container};
  }

  @include breakpoint($mq-col2) {
    grid-template-columns: $col2-uniboard-width var(--gauge-width) $block-gap $col2-uniboard-table;
    grid-template-rows: fit-content(0);
    grid-template-areas:
    'board      gauge .    tools'
    'under      under .    controls'
    'under      under .    acpl'
    'under      under .    side'
    'chat       chat  .    side'
    'uchat      uchat .    side';
    grid-row-gap: 0;
    &__underboard,
    &__side,
    .chat__members,
    .mchat {
      margin-top: $block-gap;
    }
    .eval-gauge { display: block; }
  }

  @include breakpoint($mq-col2-uniboard-squeeze) {
    grid-template-columns: $col2-uniboard-squeeze-width var(--gauge-width) $block-gap $col2-uniboard-squeeze-table;
  }

  @include breakpoint($mq-col3) {
    grid-template-columns: $col3-uniboard-side $block-gap $col3-uniboard-width var(--gauge-width) $block-gap $col3-uniboard-table;
    grid-template-rows: $meta-height $chat-height max-content;
    grid-template-areas:
    'side    . board gauge . tools'
    'chat    . board gauge . tools'
    'uchat   . under under . controls'
    'uchat   . under under . acpl';

    &__side {
      margin-top: 0;
    }

    @include crosstable-large;
  }
}
