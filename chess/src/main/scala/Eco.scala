package lila.chess

object Eco {

  type Move = String
  type Name = String

  case class Branch(
      moves: Map[Move, Branch] = Map.empty,
      name: Option[Name] = None) {

    def get(move: Move) = moves get move

    def apply(move: Move) = get(move) getOrElse Branch()

    def add(moves: List[Move], name: Name): Branch = moves match {
      case Nil            ⇒ this
      case move :: Nil    ⇒ this.updated(move, apply(move) withName name)
      case move :: others ⇒ this.updated(move, apply(move).add(others, name))
    }

    def updated(k: Move, v: Branch) = copy(moves = moves.updated(k, v))

    def withName(n: String) = copy(name = Some(n))
  }

  def nameOf(pgn: String): Option[Name] = (pgn.split(' ').foldLeft(tree) {
    case (branch, move) ⇒ (branch get move) getOrElse branch
  }).name

  val tree: Branch = Map(
    "b3" -> "Nimzovich-Larsen Attack",
    "f4" -> "Bird's Opening",
    "f4 d5" -> "Bird's Opening",
    "Nf3" -> "Reti Opening",
    "Nf3 Nf6" -> "Reti Opening",
    "Nf3 d5" -> "Reti Opening",
    "Nf3 d5 g3" -> "King's Indian Attack",
    "Nf3 d5 g3 c5 Bg2" -> "King's Indian Attack",
    "Nf3 d5 c4" -> "Reti Opening",
    "c4" -> "English",
    "c4 c6" -> "English, Caro-Kann Defensive System",
    "c4 c6 Nf3 d5 b3" -> "English with b3",
    "c4 e6" -> "English",
    "c4 e6 Nf3 d5 g3 Nf6 Bg2 Be7 O-O" -> "English",
    "c4 Nf6" -> "English",
    "c4 Nf6 Nc3" -> "English",
    "c4 Nf6 Nc3 e6" -> "English",
    "c4 Nf6 Nc3 e6 e4" -> "English, Mikenas-Carls",
    "c4 Nf6 Nc3 e6 e4 c5" -> "English, Mikenas-Carls, Sicilian Variation",
    "c4 e5" -> "English",
    "c4 e5 Nc3" -> "English",
    "c4 e5 Nc3 Nf6" -> "English",
    "c4 e5 Nc3 Nf6 g3 c6" -> "English, Bremen System, Keres Variation",
    "c4 e5 Nc3 Nf6 g3 g6" -> "English, Bremen System with ...g6",
    "c4 e5 Nc3 Nc6" -> "English",
    "c4 e5 Nc3 Nc6 g3 g6 Bg2 Bg7 d3 d6" -> "English",
    "c4 e5 Nc3 Nc6 Nf3" -> "English, Three Knights System",
    "c4 e5 Nc3 Nc6 Nf3 Nf6" -> "English",
    "c4 e5 Nc3 Nc6 Nf3 Nf6 g3" -> "English, Four Knights, Kingside Fianchetto",
    "c4 c5" -> "English, Symmetrical",
    "c4 c5 Nf3 Nf6 d4" -> "English, Symmetrical, Benoni Formation",
    "c4 c5 Nf3 Nf6 d4 cxd4 Nxd4 e6" -> "English, Symmetrical Variation",
    "c4 c5 Nf3 Nf6 d4 cxd4 Nxd4 e6 Nc3 Nc6" -> "English, Symmetrical",
    "c4 c5 Nc3" -> "English, Symmetrical",
    "c4 c5 Nc3 Nc6" -> "English, Symmetrical",
    "c4 c5 Nc3 Nc6 g3" -> "English",
    "c4 c5 Nc3 Nc6 g3 g6 Bg2 Bg7 Nf3" -> "English, Symmetrical",
    "c4 c5 Nc3 Nc6 g3 g6 Bg2 Bg7 Nf3 Nf6" -> "English, Symmetrical",
    "c4 c5 Nc3 Nc6 g3 g6 Bg2 Bg7 Nf3 Nf6 O-O O-O d4" -> "English, Symmetrical, Main line with d4",
    "d4" -> "Queen's Pawn Game",
    "d4 d6" -> "Queen's Pawn Game (with ...d6)",
    "d4 d6 c4 g6 Nc3 Bg7 e4" -> "Modern Defense, Averbakh System",
    "d4 c5" -> "Old Benoni",
    "d4 c5 d5 e5" -> "Old Benoni Defense",
    "d4 Nf6" -> "Queen's Pawn Game",
    "d4 Nf6 Nf3" -> "Queen's Pawn Game",
    "d4 Nf6 Nf3 b6" -> "Queen's Indian",
    "d4 Nf6 Nf3 g6" -> "King's Indian",
    "d4 Nf6 Nf3 g6 g3" -> "King's Indian, Fianchetto without c4",
    "d4 Nf6 c4" -> "Queen's Pawn Game",
    "d4 Nf6 c4 e5" -> "Budapest Gambit",
    "d4 Nf6 c4 e5 dxe5 Ng4" -> "Budapest Gambit",
    "d4 Nf6 c4 d6" -> "Old Indian",
    "d4 Nf6 c4 d6 Nc3 e5 Nf3" -> "Old Indian, Ukrainian Variation, 4.Nf3",
    "d4 Nf6 c4 d6 Nc3 e5 Nf3 Nbd7 e4" -> "Old Indian, Main line",
    "d4 Nf6 c4 c5" -> "Benoni Defense",
    "d4 Nf6 c4 c5 d5 b5" -> "Benko Gambit",
    "d4 Nf6 c4 c5 d5 b5 cxb5 a6 bxa6" -> "Benko Gambit",
    "d4 Nf6 c4 c5 d5 b5 cxb5 a6 bxa6 Bxa6 Nc3 d6 e4" -> "Benko Gambit",
    "d4 Nf6 c4 c5 d5 e6" -> "Benoni Defense",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 Nf3 g6" -> "Benoni",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 Nf3 g6 g3 Bg7 Bg2 O-O" -> "Benoni, Fianchetto Variation",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 Nf3 g6 g3 Bg7 Bg2 O-O 9" -> "Benoni, Fianchetto, 9...Nbd7",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 Nf3 g6 g3 Bg7 Bg2 O-O 9" -> "Benoni, Fianchetto, 11...Re8",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4" -> "Benoni, 6.e4",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 f4" -> "Benoni",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 f4 Bg7 Bb5+" -> "Benoni, Taimanov Variation",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 f4 Bg7 Nf3 O-O" -> "Benoni, Four Pawns Attack",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 f4 Bg7 Nf3 O-O 9" -> "Benoni, Four Pawns Attack, Main line",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3" -> "Benoni, Classical with 7.Nf3",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Bg5" -> "Benoni, Classical, 8.Bg5",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O" -> "Benoni, Classical without 9.O-O",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O 9" -> "Benoni, Classical, 9.O-O",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O 9" -> "Benoni, Classical, 9...a6, 10.a4",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O 9" -> "Benoni, Classical with ...a6 and 10...Bg4",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O 9" -> "Benoni, Classical, 9...Re8",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O 9" -> "Benoni, Classical, 9...Re8, 10.Nd2",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O 9" -> "Benoni, Classical with ...Re8 and ...Na6",
    "d4 Nf6 c4 c5 d5 e6 Nc3 exd5 cxd5 d6 e4 g6 Nf3 Bg7 Be2 O-O 9" -> "Benoni, Classical, 11.f3",
    "d4 f5" -> "Dutch",
    "d4 f5 g3" -> "Dutch",
    "d4 f5 e4" -> "Dutch, Staunton Gambit",
    "d4 f5 e4 fxe4 Nc3 Nf6 Bg5" -> "Dutch, Staunton Gambit",
    "d4 f5 c4" -> "Dutch",
    "d4 f5 c4 Nf6 Nc3" -> "Dutch, with c4 & Nc3",
    "d4 f5 c4 Nf6 g3" -> "Dutch",
    "d4 f5 c4 Nf6 g3 g6 Bg2 Bg7 Nf3" -> "Dutch, Leningrad, Main Variation",
    "d4 f5 c4 Nf6 g3 g6 Bg2 Bg7 Nf3 O-O O-O d6 Nc3 c6" -> "Dutch, Leningrad, Main Variation with c6",
    "d4 f5 c4 Nf6 g3 g6 Bg2 Bg7 Nf3 O-O O-O d6 Nc3 Nc6" -> "Dutch, Leningrad, Main Variation with Nc6",
    "d4 f5 c4 Nf6 g3 e6 Bg2" -> "Dutch",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7" -> "Dutch Defense",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O" -> "Dutch",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O O-O d5 b3" -> "Dutch, Stonewall, Botvinnik Variation",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O O-O d5 b3 c6 Ba3" -> "Dutch, Stonewall with Ba3",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O O-O d5 Nc3 c6" -> "Dutch, Stonewall",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O O-O d6" -> "Dutch, Classical Variation",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O O-O d6 Nc3 Qe8" -> "Dutch, Ilyin-Genevsky",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O O-O d6 Nc3 Qe8 Qc2" -> "Dutch, Ilyin-Genevsky Variation with Qc2",
    "d4 f5 c4 Nf6 g3 e6 Bg2 Be7 Nf3 O-O O-O d6 Nc3 Qe8 b3" -> "Dutch, Ilyin-Genevsky Variation with b3",
    "e4" -> "Uncommon King's Pawn Opening",
    "e4 d5" -> "Scandinavian",
    "e4 Nf6" -> "Alekhine's Defense",
    "e4 Nf6 e5 Nd5 d4" -> "Alekhine's Defense",
    "e4 Nf6 e5 Nd5 d4 d6 Nf3" -> "Alekhine's Defense, Modern",
    "e4 Nf6 e5 Nd5 d4 d6 Nf3 Bg4" -> "Alekhine's Defense, Modern",
    "e4 g6" -> "Robatsch",
    "e4 d6 d4 Nf6" -> "Pirc",
    "e4 d6 d4 Nf6 Nc3 g6 Nf3" -> "Pirc, Classical",
    "e4 d6 d4 Nf6 Nc3 g6 f4" -> "Pirc, Austrian Attack",
    "e4 c6" -> "Caro-Kann",
    "e4 c6 Nc3 d5 Nf3 Bg4" -> "Caro-Kann, Two Knights, 3...Bg4",
    "e4 c6 d4" -> "Caro-Kann Defense",
    "e4 c6 d4 d5 exd5 cxd5" -> "Caro-Kann, Exchange",
    "e4 c6 d4 d5 exd5 cxd5 c4 Nf6 Nc3 e6" -> "Caro-Kann, Panov-Botvinnik Attack",
    "e4 c6 d4 d5 Nc3" -> "Caro-Kann",
    "e4 c6 d4 d5 Nc3 dxe4 Nxe4 Nf6 Nxf6+ gxf6" -> "Caro-Kann, Bronstein-Larsen Variation",
    "e4 c6 d4 d5 Nc3 dxe4 Nxe4 Nd7" -> "Caro-Kann, Steinitz Variation",
    "e4 c6 d4 d5 Nc3 dxe4 Nxe4 Bf5" -> "Caro-Kann, Classical",
    "e4 c6 d4 d5 Nc3 dxe4 Nxe4 Bf5 Ng3 Bg6 h4 h6 Nf3 Nd7" -> "Caro-Kann, Classical",
    "e4 c5" -> "Sicilian",
    "e4 c5 f4" -> "Sicilian, 2.f4 and 2.d4",
    "e4 c5 c3" -> "Sicilian, Alapin",
    "e4 c5 Nc3" -> "Sicilian, Closed",
    "e4 c5 Nc3 Nc6 g3" -> "Sicilian, Closed",
    "e4 c5 Nc3 Nc6 g3 g6 Bg2 Bg7 d3 d6" -> "Sicilian, Closed",
    "e4 c5 Nc3 Nc6 g3 g6 Bg2 Bg7 d3 d6 Be3" -> "Sicilian, Closed, 6.Be3",
    "e4 c5 Nf3" -> "Sicilian",
    "e4 c5 Nf3 a6" -> "Sicilian, O'Kelly Variation",
    "e4 c5 Nf3 Nf6" -> "Sicilian, Nimzovich-Rubinstein",
    "e4 c5 Nf3 Nc6" -> "Sicilian",
    "e4 c5 Nf3 Nc6 Bb5 g6" -> "Sicilian, Rossolimo Variation",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 e5" -> "Sicilian",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4" -> "Sicilian",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 g6 Nxc6" -> "Sicilian, Accelerated Fianchetto",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 g6 Nc3 Bg7 Be3 Nf6 Bc4" -> "Sicilian, Accelerated Fianchetto, Modern Variation with Bc4",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 g6 c4" -> "Sicilian, Accelerated Fianchetto",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 g6 c4 Bg7" -> "Sicilian, Accelerated Fianchetto",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 g6 c4 Bg7 Be3" -> "Sicilian, Accelerated Fianchetto, Maroczy Bind, 6.Be3",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 g6 c4 Bg7 Be3 Nf6 Nc3 Ng4" -> "Sicilian, Accelerated Fianchetto, Breyer Variation",
    "e4 c5 Nf3 e6" -> "Sicilian",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 a6" -> "Sicilian, Kan",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 a6 Bd3" -> "Sicilian, Kan",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 a6 Nc3" -> "Sicilian, Kan, 5.Nc3",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 Nc6" -> "Sicilian",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 Nc6 Nc3" -> "Sicilian, Taimanov",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 Nc6 Nc3 a6" -> "Sicilian, Taimanov Variation",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 Nc6 Nc3 Qc7" -> "Sicilian, Taimanov (Bastrikov) Variation",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 Nc6 Nc3 Qc7 Be3" -> "Sicilian, Taimanov Variation",
    "e4 c5 Nf3 e6 d4 cxd4 Nxd4 Nc6 Nc3 Qc7 Be3 a6 Be2" -> "Sicilian, Taimanov Variation",
    "e4 c5 Nf3 d6" -> "Sicilian",
    "e4 c5 Nf3 d6 Bb5+" -> "Sicilian, Canal-Sokolsky (Rossolimo) Attack",
    "e4 c5 Nf3 d6 Bb5+ Bd7" -> "Sicilian, Canal-Sokolsky (Rossolimo) Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Qxd4" -> "Sicilian",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4" -> "Sicilian",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 f3 e5 Bb5+" -> "Sicilian, Prins Variation, Venice Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3" -> "Sicilian",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bc4" -> "Sicilian",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 Nf6 Nc3 d6 Be2" -> "Sicilian",
    "e4 c5 Nf3 Nc6 d4 cxd4 Nxd4 Nf6 Nc3 d6 Be2 e5 Nb3" -> "Sicilian, Boleslavsky Variation, 7.Nb3",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5" -> "Sicilian, Richter-Rauzer",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 Bd7 Qd2" -> "Sicilian, Richter-Rauzer, Larsen Variation, 7.Qd2",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6" -> "Sicilian, Richter-Rauzer",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6 Qd2" -> "Sicilian, Richter-Rauzer Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6 Qd2 Be7 O-O-O O-O f4" -> "Sicilian, Richter-Rauzer Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6 Qd2 Be7 O-O-O O-O f4 Nxd4 10 Qxd4" -> "Sicilian, Richter-Rauzer Attack, 7...Be7 Defense, 9...Nxd4",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6 Qd2 a6" -> "Sicilian, Richter-Rauzer Attack, 7...a6",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6 Qd2 a6 O-O-O Bd7" -> "Sicilian, Richter-Rauzer Attack, 7...a6 Defense, 8...Bd7",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6 Qd2 a6 O-O-O Bd7 f4 Be7" -> "Sicilian, Richter-Rauzer Attack, 7...a6 Defense, 9...Be7",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 Nc6 Bg5 e6 Qd2 a6 O-O-O Bd7 f4 Be7 10 Nf3 b5 11 Bxf6" -> "Sicilian, Richter-Rauzer Attack, 7...a6 Defense, 11.Bxf6",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6" -> "Sicilian, Dragon Variation",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 f4" -> "Sicilian, Dragon, Levenfish Variation",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3" -> "Sicilian, Dragon",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3 Bg7 Be2 Nc6 O-O" -> "Sicilian, Dragon, Classical",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3 Bg7 Be2 Nc6 O-O O-O Nb3" -> "Sicilian, Dragon, Classical",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3 Bg7 f3" -> "Sicilian, Dragon, Yugoslav Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3 Bg7 f3 O-O" -> "Sicilian, Dragon, Yugoslav Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3 Bg7 f3 O-O Qd2 Nc6 Bc4" -> "Sicilian, Dragon, Yugoslav Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3 Bg7 f3 O-O Qd2 Nc6 Bc4 Bd7 10 O-O-O" -> "Sicilian, Dragon, Yugoslav Attack, 10.castle long",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 g6 Be3 Bg7 f3 O-O Qd2 Nc6 Bc4 Bd7 10 O-O-O Qa5 11 Bb3 Rfc8 12 h4" -> "Sicilian, Dragon, Yugoslav Attack, 12.h4",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6" -> "Sicilian, Scheveningen",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 g4" -> "Sicilian, Scheveningen, Keres Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 f4" -> "Sicilian, Scheveningen",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 Be2" -> "Sicilian",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 Be2 a6" -> "Sicilian, Scheveningen",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 Be2 a6 O-O Qc7 f4 Nc6" -> "Sicilian, Scheveningen, Classical",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 Bc4" -> "Sicilian, Fischer-Sozin Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 Bc4 a6 Bb3 b5" -> "Sicilian, Fischer-Sozin with ...a6 and ...b5",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 Bc4 Nc6" -> "Sicilian, Fischer-Sozin Attack",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 e6 Bc4 Nc6 Be3" -> "Sicilian",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6" -> "Sicilian, Najdorf",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 g3" -> "Sicilian, Najdorf, Zagreb (Fianchetto) Variation",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 Be2" -> "Sicilian, Najdorf, Opocensky Variation",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 f4" -> "Sicilian, Najdorf, 6.f4",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 Bg5" -> "Sicilian, Najdorf",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 Bg5 e6" -> "Sicilian, Najdorf, 6...e6",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 Bg5 e6 f4" -> "Sicilian, Najdorf",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 Bg5 e6 f4 Qb6" -> "Sicilian, Najdorf",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 Bg5 e6 f4 Be7" -> "Sicilian, Najdorf",
    "e4 c5 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nc3 a6 Bg5 e6 f4 Be7 Qf3 Qc7 O-O-O Nbd7" -> "Sicilian, Najdorf, 7...Be7 Main line",
    "e4 e6" -> "French Defense",
    "e4 e6 d4 d5 exd5 exd5 Nc3 Nf6 Bg5" -> "French, Exchange",
    "e4 e6 d4 d5 e5" -> "French, Advance",
    "e4 e6 d4 d5 Nd2" -> "French, Tarrasch",
    "e4 e6 d4 d5 Nd2 Nc6 Ngf3 Nf6" -> "French, Tarrasch, Guimard Main line",
    "e4 e6 d4 d5 Nd2 Nf6" -> "French, Tarrasch",
    "e4 e6 d4 d5 Nd2 Nf6 e5 Nfd7 Bd3 c5 c3 Nc6 Ne2 cxd4 cxd4" -> "French, Tarrasch",
    "e4 e6 d4 d5 Nd2 c5" -> "French, Tarrasch",
    "e4 e6 d4 d5 Nd2 c5 exd5 exd5" -> "French, Tarrasch, Open, 4.ed ed",
    "e4 e6 d4 d5 Nd2 c5 exd5 exd5 Ngf3 Nc6" -> "French, Tarrasch, Open Variation, Main line",
    "e4 e6 d4 d5 Nc3" -> "French",
    "e4 e6 d4 d5 Nc3 Nf6" -> "French",
    "e4 e6 d4 d5 Nc3 Nf6 Bg5 Bb4" -> "French, McCutcheon",
    "e4 e6 d4 d5 Nc3 Nf6 Bg5 Be7" -> "French",
    "e4 e6 d4 d5 Nc3 Nf6 Bg5 Be7 e5 Nfd7 Bxe7 Qxe7" -> "French, Classical",
    "e4 e6 d4 d5 Nc3 Bb4" -> "French, Winawer",
    "e4 e6 d4 d5 Nc3 Bb4 e5" -> "French, Winawer",
    "e4 e6 d4 d5 Nc3 Bb4 e5 c5" -> "French, Winawer, Advance",
    "e4 e6 d4 d5 Nc3 Bb4 e5 c5 a3 Bxc3+ bxc3" -> "French, Winawer",
    "e4 e6 d4 d5 Nc3 Bb4 e5 c5 a3 Bxc3+ bxc3 Ne7" -> "French, Winawer, Advance",
    "e4 e5" -> "King's Pawn Game",
    "e4 e5 d4 exd4" -> "Center Game",
    "e4 e5 d4 exd4 Qxd4 Nc6" -> "Center Game",
    "e4 e5 Bc4" -> "Bishop's Opening",
    "e4 e5 Bc4 Nf6" -> "Bishop's Opening",
    "e4 e5 Nc3" -> "Vienna",
    "e4 e5 Nc3 Nf6" -> "Vienna",
    "e4 e5 Nc3 Nf6 Bc4 Nxe4" -> "Vienna Game",
    "e4 e5 Nc3 Nf6 Bc4 Nc6" -> "Vienna Game",
    "e4 e5 Nc3 Nf6 f4" -> "Vienna Gambit",
    "e4 e5 f4" -> "King's Gambit Declined",
    "e4 e5 f4 d5" -> "King's Gambit Declined, Falkbeer Counter Gambit",
    "e4 e5 f4 d5 exd5 e4 d3 Nf6" -> "King's Gambit Declined, Falkbeer Counter Gambit",
    "e4 e5 f4 exf4" -> "King's Gambit Accepted",
    "e4 e5 f4 exf4 Nf3" -> "King's Gambit Accepted",
    "e4 e5 f4 exf4 Nf3 Be7" -> "King's Gambit Accepted, Cunningham",
    "e4 e5 f4 exf4 Nf3 d5" -> "King's Gambit Accepted, Abbazia Defense",
    "e4 e5 f4 exf4 Nf3 g5 Nc3" -> "King's Gambit Accepted",
    "e4 e5 f4 exf4 Nf3 g5 Bc4 Bg7" -> "King's Gambit Accepted",
    "e4 e5 f4 exf4 Nf3 g5 h4" -> "King's Gambit Accepted",
    "e4 e5 Nf3" -> "King's Knight Opening",
    "e4 e5 Nf3 d6" -> "Philidor Defense",
    "e4 e5 Nf3 Nf6" -> "Petrov Defense",
    "e4 e5 Nf3 Nf6 d4 exd4 e5 Ne4 Qxd4" -> "Petrov, Modern Attack",
    "e4 e5 Nf3 Nc6" -> "King's Pawn Game",
    "e4 e5 Nf3 Nc6 d4 exd4 Nxd4" -> "Scotch Game",
    "e4 e5 Nf3 Nc6 Nc3" -> "Three Knights",
    "e4 e5 Nf3 Nc6 Nc3 Nf6" -> "Four Knights",
    "e4 e5 Nf3 Nc6 Nc3 Nf6 Bb5" -> "Four Knights",
    "e4 e5 Nf3 Nc6 Nc3 Nf6 Bb5 Bb4" -> "Four Knights",
    "e4 e5 Nf3 Nc6 Bc4 Bc5" -> "Giuoco Piano",
    "e4 e5 Nf3 Nc6 Bc4 Bc5 b4" -> "Evans Gambit",
    "e4 e5 Nf3 Nc6 Bc4 Bc5 b4 Bxb4 c3 Ba5" -> "Evans Gambit",
    "e4 e5 Nf3 Nc6 Bc4 Bc5 c3" -> "Giuoco Piano",
    "e4 e5 Nf3 Nc6 Bc4 Bc5 c3 Nf6 d4 exd4 cxd4" -> "Giuoco Piano",
    "e4 e5 Nf3 Nc6 Bc4 Nf6" -> "Two Knights Defense",
    "e4 e5 Nf3 Nc6 Bc4 Nf6 d4 exd4 O-O Nxe4" -> "Two Knights",
    "e4 e5 Nf3 Nc6 Bc4 Nf6 Ng5" -> "Two Knights",
    "e4 e5 Nf3 Nc6 Bc4 Nf6 Ng5 d5 exd5 Na5" -> "Two Knights",
    "e4 e5 Nf3 Nc6 Bc4 Nf6 Ng5 d5 exd5 Na5 Bb5+ c6 dxc6 bxc6 Be2 h6" -> "Two Knights",
    "e4 e5 Nf3 Nc6 Bb5" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 Nd4" -> "Ruy Lopez, Bird's Defense",
    "e4 e5 Nf3 Nc6 Bb5 d6" -> "Ruy Lopez, Old Steinitz Defense",
    "e4 e5 Nf3 Nc6 Bb5 f5" -> "Ruy Lopez, Schliemann Defense",
    "e4 e5 Nf3 Nc6 Bb5 Bc5" -> "Ruy Lopez, Classical",
    "e4 e5 Nf3 Nc6 Bb5 Nf6" -> "Ruy Lopez, Berlin Defense",
    "e4 e5 Nf3 Nc6 Bb5 Nf6 O-O d6" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 Nf6 O-O Nxe4" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 a6 Bxc6" -> "Ruy Lopez, Exchange",
    "e4 e5 Nf3 Nc6 Bb5 a6 Bxc6 dc O-O f6 d4" -> "Ruy Lopez, Exchange, Gligoric Variation, 6.d4",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 d6" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 d6 O-O" -> "Ruy Lopez, Modern Steinitz Defense, 5.O-O",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 d6 Bxc6+ bxc6 d4" -> "Ruy Lopez, Modern Steinitz Defense",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 d6 c3" -> "Ruy Lopez, Modern Steinitz Defense",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 d6 c3 Bd7" -> "Ruy Lopez, Modern Steinitz Defense",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 d6 c3 Bd7 d4 g6" -> "Ruy Lopez, Modern Steinitz Defense, Fianchetto Variation",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O d6" -> "Ruy Lopez, Steinitz Defense Deferred",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Nxe4" -> "Ruy Lopez, Open",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Nxe4 d4 b5 Bb3 d5 dxe5 Be6" -> "Ruy Lopez, Open, Howell Attack",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Nxe4 d4 b5 Bb3 d5 dxe5 Be6 c3" -> "Ruy Lopez, Open",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Nxe4 d4 b5 Bb3 d5 dxe5 Be6" -> "Ruy Lopez, Open",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7" -> "Ruy Lopez, Closed",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Bxc6 dxc6" -> "Ruy Lopez, Exchange Variation Doubly Deferred (DERLD)",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Qe2" -> "Ruy Lopez, Worrall Attack",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 d6" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3" -> "Ruy Lopez",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d5" -> "Ruy Lopez, Marshall",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6" -> "Ruy Lopez, Closed",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 d4" -> "Ruy Lopez, Closed",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3" -> "Ruy Lopez, Closed",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3 h6" -> "Ruy Lopez, Closed, Smyslov Defense",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3 Nb8" -> "Ruy Lopez, Closed, Breyer Defense",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3 Nb8 10 d4" -> "Ruy Lopez, Closed, Breyer",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3 Na5 10 Bc2" -> "Ruy Lopez, Closed",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3 Na5 10 Bc2 c5 11 d4 Qc7" -> "Ruy Lopez, Closed, Chigorin",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3 Na5 10 Bc2 c5 11 d4 Qc7 12 Nbd2 Nc6" -> "Ruy Lopez, Closed, Chigorin",
    "e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7 Re1 b5 Bb3 O-O c3 d6 h3 Na5 10 Bc2 c5 11 d4 Qc7 12 Nbd2 cxd4 13 cxd4" -> "Ruy Lopez, Closed, Chigorin, 12...cd",
    "d4 d5" -> "Queen's Pawn Game",
    "d4 d5 Nc3 Nf6 Bg5" -> "Richter-Veresov Attack",
    "d4 d5 Nf3" -> "Queen's Pawn Game",
    "d4 d5 Nf3 Nf6 Bg5" -> "Torre Attack (Tartakower Variation)",
    "d4 d5 Nf3 Nf6 e3" -> "Queen's Pawn Game",
    "d4 d5 Nf3 Nf6 e3 e6" -> "Queen's Pawn Game",
    "d4 d5 c4" -> "Queen's Gambit Declined",
    "d4 d5 c4 Nc6" -> "Queen's Gambit Declined, Chigorin Defense",
    "d4 d5 c4 e5" -> "Queen's Gambit Declined, Albin Counter Gambit",
    "d4 d5 c4 e5 dxe5 d4 Nf3 Nc6 g3" -> "Queen's Gambit Declined, Albin Counter Gambit, 5.g3",
    "d4 d5 c4 c6" -> "Queen's Gambit Declined Slav",
    "d4 d5 c4 c6 Nf3" -> "Queen's Gambit Declined Slav",
    "d4 d5 c4 c6 Nf3 Nf6 e3 Bf5" -> "Queen's Gambit Declined Slav",
    "d4 d5 c4 c6 Nf3 Nf6 cxd5 cxd5" -> "Queen's Gambit Declined Slav, Exchange Variation",
    "d4 d5 c4 c6 Nf3 Nf6 cxd5 cxd5 Nc3 Nc6 Bf4 Bf5" -> "Queen's Gambit Declined Slav, Exchange Variation",
    "d4 d5 c4 c6 Nf3 Nf6 Nc3" -> "Queen's Gambit Declined Slav",
    "d4 d5 c4 c6 Nf3 Nf6 Nc3 dxc4 a4" -> "Queen's Gambit Declined Slav",
    "d4 d5 c4 c6 Nf3 Nf6 Nc3 dxc4 a4 Bf5" -> "Queen's Gambit Declined Slav",
    "d4 d5 c4 c6 Nf3 Nf6 Nc3 dxc4 a4 Bf5 e3" -> "Queen's Gambit Declined Slav, Dutch",
    "d4 d5 c4 c6 Nf3 Nf6 Nc3 dxc4 a4 Bf5 e3 e6 Bxc4 Bb4 O-O O-O Qe2" -> "Queen's Gambit Declined Slav, Dutch",
    "d4 d5 c4 dxc4" -> "Queen's Gambit Accepted",
    "d4 d5 c4 dxc4 Nf3" -> "Queen's Gambit Accepted",
    "d4 d5 c4 dxc4 Nf3 a6 e3 Bg4 Bxc4 e6 d5" -> "Queen's Gambit Accepted",
    "d4 d5 c4 dxc4 Nf3 Nf6" -> "Queen's Gambit Accepted",
    "d4 d5 c4 dxc4 Nf3 Nf6 Nc3" -> "Queen's Gambit Accepted",
    "d4 d5 c4 dxc4 Nf3 Nf6 e3" -> "Queen's Gambit Accepted",
    "d4 d5 c4 dxc4 Nf3 Nf6 e3 e6" -> "Queen's Gambit Accepted",
    "d4 d5 c4 dxc4 Nf3 Nf6 e3 e6 Bxc4 c5 O-O a6" -> "Queen's Gambit Accepted, Classical",
    "d4 d5 c4 dxc4 Nf3 Nf6 e3 e6 Bxc4 c5 O-O a6 Qe2" -> "Queen's Gambit Accepted, Classical",
    "d4 d5 c4 dxc4 Nf3 Nf6 e3 e6 Bxc4 c5 O-O a6 Qe2 b5 Bb3 Bb7" -> "Queen's Gambit Accepted, Classical",
    "d4 d5 c4 e6" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 c5" -> "Queen's Gambit Declined, Tarrasch",
    "d4 d5 c4 e6 Nc3 c5 cxd5 exd5 Nf3 Nc6 g3" -> "Queen's Gambit Declined, Tarrasch",
    "d4 d5 c4 e6 Nc3 c5 cxd5 exd5 Nf3 Nc6 g3 Nf6 Bg2 Be7" -> "Queen's Gambit Declined, Tarrasch",
    "d4 d5 c4 e6 Nc3 Nf6" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 cxd5 exd5 Bg5 c6 Qc2" -> "Queen's Gambit Declined, Exchange, Positional line, 6.Qc2",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 Bb4" -> "Queen's Gambit Declined, Ragozin Variation",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 Bb4 Bg5 dxc4" -> "Queen's Gambit Declined, Ragozin, Vienna Variation",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c5" -> "Queen's Gambit Declined, Semi-Tarrasch",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c5 cxd5" -> "Queen's Gambit Declined, Semi-Tarrasch",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c5 cxd5 Nxd5 e3 Nc6 Bd3" -> "Queen's Gambit Declined, Semi-Tarrasch, 7.Bd3",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c6" -> "Queen's Gambit Declined Semi-Slav",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c6 Bg5 dxc4" -> "Queen's Gambit Declined Semi-Slav",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c6 e3" -> "Queen's Gambit Declined Semi-Slav",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c6 e3 Nbd7 Bd3" -> "Queen's Gambit Declined Semi-Slav",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c6 e3 Nbd7 Bd3 dxc4 Bxc4" -> "Queen's Gambit Declined Semi-Slav",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c6 e3 Nbd7 Bd3 dxc4 Bxc4 b5 Bd3 a6" -> "Queen's Gambit Declined Semi-Slav, Meran",
    "d4 d5 c4 e6 Nc3 Nf6 Nf3 c6 e3 Nbd7 Bd3 dxc4 Bxc4 b5 Bd3 a6 e4 c5 10 e5 cxd4 11 Nxb5" -> "Queen's Gambit Declined Semi-Slav, Meran",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Nbd7" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Nbd7 e3 c6 Nf3" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Rc1" -> "Queen's Gambit Declined, Anti-Neo-Orthodox Variation",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 h6 Bh4" -> "Queen's Gambit Declined",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 h6 Bh4 Ne4 Bxe7 Qxe7" -> "Queen's Gambit Declined, Lasker Defense",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 h6 Bh4 b6" -> "Queen's Gambit Declined, Tartakower (Makagonov-Bondarevsky) System",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 h6 Bh4 b6 cxd5 Nxd5" -> "Queen's Gambit Declined, Tartakower",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7" -> "Queen's Gambit Declined, Orthodox Defense",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Qc2" -> "Queen's Gambit Declined, Orthodox, Rubinstein Attack",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Qc2 c5 cxd5" -> "Queen's Gambit Declined, Orthodox, Rubinstein Attack",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Rc1" -> "Queen's Gambit Declined, Orthodox Defense",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Rc1 c6 Qc2" -> "Queen's Gambit Declined, Orthodox, Rubinstein Attack",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Rc1 c6 Qc2 a6 cxd5" -> "Queen's Gambit Declined, Orthodox, Rubinstein Attack, Main line",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Rc1 c6 Bd3" -> "Queen's Gambit Declined, Orthodox Defense, Bd3 line",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Rc1 c6 Bd3 dxc4 Bxc4 Nd5" -> "Queen's Gambit Declined, Orthodox Defense, Bd3 line",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Rc1 c6 Bd3 dxc4" -> "Queen's Gambit Declined, Orthodox Defense, Classical",
    "d4 d5 c4 e6 Nc3 Nf6 Bg5 Be7 e3 O-O Nf3 Nbd7 Rc1 c6 Bd3 dxc4" -> "Queen's Gambit Declined, Orthodox Defense, Classical, 13.de",
    "d4 Nf6 c4 g6 f3 d5" -> "Neo-Grunfeld Defense",
    "d4 Nf6 c4 g6 g3 d5" -> "Neo-Grunfeld",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 cxd5 Nxd5 e4 Nb6 Ne2" -> "Neo-Grunfeld, 5.cd, Main line",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 Nf3" -> "Neo-Grunfeld, 5.Nf3",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 Nf3 O-O cxd5 Nxd5 O-O" -> "Neo-Grunfeld, 6.cd Nxd5, 7.O-O",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 Nf3 O-O cxd5 Nxd5 O-O c5 dxc5" -> "Neo-Grunfeld, 6.cd Nxd5, 7.O-O c5, 8.dxc5",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 Nf3 O-O cxd5 Nxd5 O-O Nb6" -> "Neo-Grunfeld, 6.cd Nxd5, 7.O-O Nb6",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 Nf3 O-O O-O" -> "Neo-Grunfeld, 6.O-O",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 Nf3 O-O O-O c6" -> "Neo-Grunfeld, 6.O-O c6",
    "d4 Nf6 c4 g6 g3 d5 Bg2 Bg7 Nf3 O-O O-O c6 cxd5 cxd5" -> "Neo-Grunfeld, 6.O-O, Main line",
    "d4 Nf6 c4 g6 Nc3 d5" -> "Grunfeld",
    "d4 Nf6 c4 g6 Nc3 d5 Qb3" -> "Grunfeld, Russian Variation",
    "d4 Nf6 c4 g6 Nc3 d5 Bf4" -> "Grunfeld, 4.Bf4",
    "d4 Nf6 c4 g6 Nc3 d5 Bf4 Bg7 e3 O-O" -> "Grunfeld, Grunfeld Gambit",
    "d4 Nf6 c4 g6 Nc3 d5 Bf4 Bg7 e3 O-O cxd5 Nxd5 Nxd5 Qxd5 Bxc7" -> "Grunfeld, Grunfeld Gambit Accepted",
    "d4 Nf6 c4 g6 Nc3 d5 cxd5 Nxd5" -> "Grunfeld",
    "d4 Nf6 c4 g6 Nc3 d5 cxd5 Nxd5 e4 Nxc3 bxc3 Bg7 Bc4" -> "Grunfeld, Exchange",
    "d4 Nf6 c4 g6 Nc3 d5 cxd5 Nxd5 e4 Nxc3 bxc3 Bg7 Bc4 O-O Ne2 c5" -> "Grunfeld, Exchange",
    "d4 Nf6 c4 g6 Nc3 d5 cxd5 Nxd5 e4 Nxc3 bxc3 Bg7 Bc4 O-O Ne2" -> "Grunfeld, Spassky Variation, Main line, 10...cd, 11.cd",
    "d4 Nf6 c4 g6 Nc3 d5 cxd5 Nxd5 e4 Nxc3 bxc3 Bg7 Bc4 O-O Ne2" -> "Grunfeld",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3" -> "Grunfeld",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 Bg5" -> "Grunfeld, 5.Bg5",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 Bf4" -> "Grunfeld, 5.Bf4",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 Bf4 O-O e3" -> "Grunfeld, with Bf4 & e3",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 e3" -> "Grunfeld",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 e3 O-O Qb3" -> "Grunfeld",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 Qb3" -> "Grunfeld, Russian Variation",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 Qb3 dxc4 Qxc4 O-O e4" -> "Grunfeld, Russian",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 Qb3 dxc4 Qxc4 O-O e4 Bg4" -> "Grunfeld, Russian",
    "d4 Nf6 c4 g6 Nc3 d5 Nf3 Bg7 Qb3 dxc4 Qxc4 O-O e4 Bg4 Be3" -> "Grunfeld Defense, Smyslov",
    "d4 Nf6 c4 e6" -> "Queen's Pawn Game",
    "d4 Nf6 c4 e6 g3 d5 Bg2" -> "Catalan, Closed",
    "d4 Nf6 c4 e6 g3 d5 Bg2 dxc4 Qa4+" -> "Catalan, Open, 5.Qa4",
    "d4 Nf6 c4 e6 g3 d5 Bg2 dxc4 Qa4+ Nbd7 Qxc4" -> "Catalan, Open",
    "d4 Nf6 c4 e6 g3 d5 Bg2 dxc4 Nf3" -> "Catalan, Open, 5.Nf3",
    "d4 Nf6 c4 e6 g3 d5 Bg2 dxc4 Nf3 Be7" -> "Catalan, Open, Classical line",
    "d4 Nf6 c4 e6 g3 d5 Bg2 Be7 Nf3" -> "Catalan, Closed, 5.Nf3",
    "d4 Nf6 c4 e6 g3 d5 Bg2 Be7 Nf3 O-O O-O Nbd7" -> "Catalan, Closed",
    "d4 Nf6 c4 e6 g3 d5 Bg2 Be7 Nf3 O-O O-O Nbd7 Qc2" -> "Catalan, Closed",
    "d4 Nf6 c4 e6 g3 d5 Bg2 Be7 Nf3 O-O O-O Nbd7 Qc2 c6 Nbd2" -> "Catalan, Closed",
    "d4 Nf6 c4 e6 Nf3" -> "Queen's Pawn Game",
    "d4 Nf6 c4 e6 Nf3 Bb4+" -> "Bogo-Indian Defense",
    "d4 Nf6 c4 e6 Nf3 b6" -> "Queen's Indian",
    "d4 Nf6 c4 e6 Nf3 b6 Nc3 Bb7 Bg5 h6 Bh4 Bb4" -> "Queen's Indian, 4.Nc3, Main line",
    "d4 Nf6 c4 e6 Nf3 b6 e3" -> "Queen's Indian",
    "d4 Nf6 c4 e6 Nf3 b6 g3" -> "Queen's Indian",
    "d4 Nf6 c4 e6 Nf3 b6 g3 Bb7 Bg2 Bb4+" -> "Queen's Indian",
    "d4 Nf6 c4 e6 Nf3 b6 g3 Bb7 Bg2 Be7" -> "Queen's Indian",
    "d4 Nf6 c4 e6 Nf3 b6 g3 Bb7 Bg2 Be7 O-O O-O Nc3" -> "Queen's Indian, Old Main line, 7.Nc3",
    "d4 Nf6 c4 e6 Nf3 b6 g3 Bb7 Bg2 Be7 O-O O-O Nc3 Ne4 Qc2 Nxc3" -> "Queen's Indian, Old Main line, 9.Qxc3",
    "d4 Nf6 c4 e6 Nc3 Bb4" -> "Nimzo-Indian",
    "d4 Nf6 c4 e6 Nc3 Bb4 Nf3" -> "Nimzo-Indian, Three Knights",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qb3" -> "Nimzo-Indian, Spielmann Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qb3 c5 dxc5 Nc6" -> "Nimzo-Indian, Spielmann",
    "d4 Nf6 c4 e6 Nc3 Bb4 a3 Bxc3+ bxc3" -> "Nimzo-Indian, Samisch",
    "d4 Nf6 c4 e6 Nc3 Bb4 a3 Bxc3+ bxc3 c5 f3 d5 cxd5" -> "Nimzo-Indian, Samisch",
    "d4 Nf6 c4 e6 Nc3 Bb4 a3 Bxc3+ bxc3 c5 e3" -> "Nimzo-Indian, Samisch",
    "d4 Nf6 c4 e6 Nc3 Bb4 a3 Bxc3+ bxc3 O-O" -> "Nimzo-Indian, Samisch Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 a3 Bxc3+ bxc3 O-O e3" -> "Nimzo-Indian, Samisch Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 a3 Bxc3+ bxc3 O-O e3 c5 Bd3 Nc6" -> "Nimzo-Indian, Samisch",
    "d4 Nf6 c4 e6 Nc3 Bb4 Bg5" -> "Nimzo-Indian, Leningrad",
    "d4 Nf6 c4 e6 Nc3 Bb4 Bg5 h6 Bh4 c5 d5 d6" -> "Nimzo-Indian, Leningrad, Main line",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2" -> "Nimzo-Indian, Classical",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2 Nc6" -> "Nimzo-Indian, Classical",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2 d5" -> "Nimzo-Indian, Classical, Noa Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2 d5 cxd5 exd5" -> "Nimzo-Indian, Classical, Noa Variation, 5.cd ed",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2 d5 a3" -> "Nimzo-Indian, Classical",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2 d5 a3 Bxc3+ Qxc3 Ne4 Qc2" -> "Nimzo-Indian, Classical",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2 c5" -> "Nimzo-Indian, Classical, 4...c5",
    "d4 Nf6 c4 e6 Nc3 Bb4 Qc2 c5 dxc5 O-O" -> "Nimzo-Indian, Classical, Pirc Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3" -> "Nimzo-Indian, 4.e3",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 c5" -> "Nimzo-Indian",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 c5 Ne2" -> "Nimzo-Indian, 4.e3 c5, 5.Ne2 (Rubinstein)",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 b6" -> "Nimzo-Indian, Fischer Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 b6 Ne2" -> "Nimzo-Indian, Fischer Variation, 5.Ne2",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 b6 Ne2 Ba6" -> "Nimzo-Indian, 4.e3, Bronstein (Byrne) Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O" -> "Nimzo-Indian",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Bd3" -> "Nimzo-Indian, 4.e3 O-O 5.Bd3",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Bd3 d5" -> "Nimzo-Indian, 4.e3 O-O 5.Bd3 d5",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Bd3 d5 a3 Bxc3+ bxc3" -> "Nimzo-Indian, 4.e3, Botvinnik System",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3" -> "Nimzo-Indian, 4.e3 O-O 5.Nf3, without ...d5",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5" -> "Nimzo-Indian, 4.e3",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 b6" -> "Nimzo-Indian, 4.e3, Main line with ...b6",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 c5" -> "Nimzo-Indian, 4.e3",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 c5 O-O dxc4 Bxc4" -> "Nimzo-Indian, 4.e3, Gligoric System",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 c5 O-O dxc4 Bxc4 Nbd7" -> "Nimzo-Indian, 4.e3, Gligoric System, Bronstein Variation",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 c5 O-O Nc6" -> "Nimzo-Indian, 4.e3, Main line with 7...Nc6",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 c5 O-O Nc6 a3 dxc4 9" -> "Nimzo-Indian, 4.e3, Main line with 8...dc and 9...cd",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 c5 O-O Nc6 a3 Bxc3 bxc3" -> "Nimzo-Indian, 4.e3, Main line with 8...Bxc3",
    "d4 Nf6 c4 e6 Nc3 Bb4 e3 O-O Nf3 d5 Bd3 c5 O-O Nc6 a3 Bxc3 bxc3 dxc4 10 Bxc4" -> "Nimzo-Indian, 4.e3, Main line",
    "d4 Nf6 c4 g6" -> "King's Indian Defense",
    "d4 Nf6 c4 g6 Nc3" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3" -> "King's Indian, Fianchetto",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3 O-O Bg2 Nc6 O-O a6" -> "King's Indian, Fianchetto, Panno Variation",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3 O-O Bg2 c5" -> "King's Indian, Fianchetto, Yugoslav System",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3 O-O Bg2 c5 O-O" -> "King's Indian, Fianchetto, Yugoslav, 7.O-O",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3 O-O Bg2 c5 O-O Nc6 d5" -> "King's Indian, Fianchetto, Yugoslav Panno",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3 O-O Bg2 Nbd7" -> "King's Indian, Fianchetto",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3 O-O Bg2 Nbd7 O-O e5 e4" -> "King's Indian, Fianchetto, Classical Variation, 8.e4",
    "d4 Nf6 c4 g6 Nc3 Bg7 Nf3 d6 g3 O-O Bg2 Nbd7 O-O e5 e4 c6 h3" -> "King's Indian, Fianchetto, Classical Main line",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 h3" -> "King's Indian, Makagonov System (5.h3)",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 g3" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Be2" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Be2 O-O Bg5 c5" -> "King's Indian, Averbakh, 6...c5",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Be2 O-O Bg5 c5 d5 e6" -> "King's Indian, Averbakh, Main line",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f4" -> "King's Indian, Four Pawns Attack",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f4 O-O Be2" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f4 O-O Be2 c5 Nf3" -> "King's Indian, Four Pawns Attack, with Be2 and Nf3",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f4 O-O Be2 c5 Nf3 cxd4 Nxd4 Nc6 Be3" -> "King's Indian, Four Pawns Attack, Main line",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3" -> "King's Indian, Samisch Variation",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O" -> "King's Indian, Samisch",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 b6" -> "King's Indian, Samisch, double Fianchetto Variation",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 Nc6" -> "King's Indian, Samisch",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 Nc6 Nge2 a6 Qd2 Rb8" -> "King's Indian, Samisch, Panno Main line",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 e5" -> "King's Indian, Samisch, Orthodox Variation",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 e5 Nge2 c6" -> "King's Indian, Samisch, Orthodox, 7.Nge2 c6",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 e5 d5" -> "King's Indian, Samisch, Orthodox",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 e5 d5 c6" -> "King's Indian, Samisch, Orthodox, 7.d5 c6",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 f3 O-O Be3 e5 d5 c6 Nge2 cxd5" -> "King's Indian, Samisch, Orthodox Main line",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5 d5 Nbd7" -> "King's Indian, Petrosian System",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5 O-O" -> "King's Indian, Orthodox",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5 O-O Nbd7 Re1" -> "King's Indian, Orthodox, 7...Nbd7, 8.Re1",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5 O-O Nbd7 Re1 c6 Bf1 a5" -> "King's Indian, Orthodox, 7...Nbd7, Main line",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5 O-O Nc6" -> "King's Indian",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5 O-O Nc6 d5 Ne7 Ne1" -> "King's Indian, Orthodox, Taimanov, 9.Ne1",
    "d4 Nf6 c4 g6 Nc3 Bg7 e4 d6 Nf3 O-O Be2 e5 O-O Nc6 d5 Ne7 Ne1 Nd7 10 f3 f5" -> "King's Indian, Orthodox, Taimanov"
  ).foldLeft(Branch()) {
      case (tree, (moves, name)) ⇒ tree.add(moves.split(' ').toList, name)
    }
}
