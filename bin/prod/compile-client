#!/bin/sh
. bin/lilarc

./ui/build prod

SRC=public/javascripts
TARGET=public/compiled
AB_FILE=${LILA_AB_FILE:-missing}

if [ ! -f $AB_FILE ]; then
  echo "Building without AB file"
fi

mkdir -p public/compiled

for file in tv.js puzzle.js user.js coordinate.js; do
  orig=$SRC/$file
  comp=$TARGET/$file
  if [[ ! -f $comp || $orig -nt $comp ]]; then
    lilalog "Compiling javascript - $file"
    # closure-compiler --js $orig --js_output_file $comp
    uglifyjs -c -m -v $orig > $comp
  fi
done
