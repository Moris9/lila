!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Chessground=e()}}(function(){return function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return o(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){"use strict";function n(e,t){return t.animation.enabled?l(e,t):o(e,t)}function o(e,t){var r=e(t);return t.dom.redraw(),r}function i(e,t,r){var n=r?v.invertKey(e):e;return{key:n,pos:v.key2pos(n),piece:t}}function a(e,t){return e.role===t.role&&e.color===t.color}function s(e,t){return t.sort(function(t,r){return v.distance(e.pos,t.pos)-v.distance(e.pos,r.pos)})[0]}function c(e,t){var r,n,o,c,u,l,d,f=t.dom.bounds.width/8,p=t.dom.bounds.height/8,b={},h=[],m={},g=[],w=[],y=e.orientation!==t.orientation,k={},P="white"===t.orientation;for(o in e.pieces)k[o]=i(o,e.pieces[o],y);for(o=0;o<v.allKeys.length;o++)c=v.allKeys[o],r=t.pieces[c],n=k[c],r?n?a(r,n.piece)||(g.push(n),w.push(i(c,r,!1))):w.push(i(c,r,!1)):n&&g.push(n);return w.forEach(function(e){n=s(e,g.filter(function(t){return a(e.piece,t.piece)})),n&&(u=P?n.pos:e.pos,l=P?e.pos:n.pos,d=[(u[0]-l[0])*f,(l[1]-u[1])*p],b[e.key]=[d,d],h.push(n.key))}),g.forEach(function(e){v.containsX(h,e.key)||t.items&&t.items(e.pos,e.key)||(m[e.key]=e.piece)}),{anims:b,fadings:m}}function u(e){var t=e.animation.current;if(!t)return void e.dom.redraw();var r=1-((new Date).getTime()-t.start)/t.duration;if(r<=0)e.animation.current=void 0,e.dom.redraw();else{var n=void 0,o=f(r);for(n in t.plan.anims){var i=t.plan.anims[n];i[1]=[p(i[0][0]*o,10),p(i[0][1]*o,10)]}e.dom.redraw(!1),v.raf(function(){return u(e)})}}function l(e,t){var r={orientation:t.orientation,pieces:{}};for(var n in t.pieces)r.pieces[n]={role:t.pieces[n].role,color:t.pieces[n].color};var o=e(t);if(t.animation.enabled){var i=c(r,t);if(d(i.anims)&&d(i.fadings))t.dom.redraw();else{var a=t.animation.current&&t.animation.current.start;t.animation.current={start:(new Date).getTime(),duration:t.animation.duration,plan:i},a||u(t)}}else t.dom.redraw();return o}function d(e){for(var t in e)return!1;return!0}function f(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}function p(e,t){return Math.round(e*t)/t}Object.defineProperty(r,"__esModule",{value:!0});var v=e("./util");r.anim=n,r.render=o},{"./util":18}],2:[function(e,t,r){"use strict";function n(e,t){return{set:function(t){c.anim(function(e){return s.configure(e,t)},e)},state:e,getFen:function(){return a.write(e.pieces)},getMaterialDiff:function(){return o.getMaterialDiff(e)},toggleOrientation:function(){o.toggleOrientation(e),t()},setPieces:function(t){c.anim(function(e){return o.setPieces(e,t)},e)},selectSquare:function(t){c.render(function(e){return o.selectSquare(e,t)},e)},move:function(t,r){c.anim(function(e){return o.baseMove(e,t,r)},e)},newPiece:function(t,r){c.anim(function(e){return o.baseNewPiece(e,t,r)},e)},playPremove:function(){e.premovable.current&&!c.anim(o.playPremove,e)&&i.raf(e.dom.redraw)},playPredrop:function(t){c.anim(function(e){return o.playPredrop(e,t)},e)},cancelPremove:function(){c.render(o.unsetPremove,e)},cancelPredrop:function(){c.render(o.unsetPredrop,e)},cancelMove:function(){c.render(function(e){o.cancelMove(e),u.cancel(e)},e)},stop:function(){c.render(function(e){o.stop(e),u.cancel(e)},e)},explode:function(t){l.default(e,t)},setAutoShapes:function(t){c.anim(function(e){return e.drawable.autoShapes=t},e)},setShapes:function(t){c.anim(function(e){return e.drawable.shapes=t},e)},redrawAll:t}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./board"),i=e("./util"),a=e("./fen"),s=e("./config"),c=e("./anim"),u=e("./drag"),l=e("./explosion");r.start=n},{"./anim":1,"./board":3,"./config":5,"./drag":6,"./explosion":9,"./fen":10,"./util":18}],3:[function(e,t,r){"use strict";function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&setTimeout(function(){return e.apply(void 0,t)},1)}function o(e){e.orientation=S.opposite(e.orientation),e.animation.current=void 0}function i(e){e.lastMove=void 0,y(e),u(e),d(e)}function a(e,t){for(var r in t)t[r]?e.pieces[r]=t[r]:delete e.pieces[r]}function s(e,t){if(t===!0&&(t=e.turnColor),t)for(var r in e.pieces)"king"===e.pieces[r].role&&e.pieces[r].color===t&&(e.check=r);else e.check=void 0}function c(e,t,r,o){d(e),e.premovable.current=[t,r],n(e.premovable.events.set,t,r,o)}function u(e){e.premovable.current&&(e.premovable.current=void 0,n(e.premovable.events.unset))}function l(e,t,r){u(e),e.predroppable.current={role:t,key:r},n(e.predroppable.events.set,t,r)}function d(e){var t=e.predroppable;t.current&&(t.current=void 0,n(t.events.unset))}function f(e,t,r){if(e.autoCastle){var n=e.pieces[r];if("king"===n.role){var o=S.key2pos(t);if(5===o[0]&&(1===o[1]||8===o[1])){var i,a,s,c=S.key2pos(r);if(7===c[0]||8===c[0])i=S.pos2key([8,o[1]]),a=S.pos2key([6,o[1]]),s=S.pos2key([7,o[1]]);else{if(3!==c[0]&&1!==c[0])return;i=S.pos2key([1,o[1]]),a=S.pos2key([4,o[1]]),s=S.pos2key([3,o[1]])}delete e.pieces[t],delete e.pieces[r],delete e.pieces[i],e.pieces[s]={role:"king",color:n.color},e.pieces[a]={role:"rook",color:n.color}}}}}function p(e,t,r){if(t===r||!e.pieces[t])return!1;var o=e.pieces[r]&&e.pieces[r].color!==e.pieces[t].color?e.pieces[r]:void 0;return r==e.selected&&y(e),n(e.events.move,t,r,o),e.pieces[r]=e.pieces[t],delete e.pieces[t],e.lastMove=[t,r],e.check=void 0,f(e,t,r),n(e.events.change),!0}function v(e,t,r,o){if(e.pieces[r]){if(!o)return!1;delete e.pieces[r]}return n(e.events.dropNewPiece,t,r),e.pieces[r]=t,e.lastMove=[r,r],e.check=void 0,n(e.events.change),e.movable.dests=void 0,e.turnColor=S.opposite(e.turnColor),!0}function b(e,t,r){var n=p(e,t,r);return n&&(e.movable.dests=void 0,e.turnColor=S.opposite(e.turnColor),e.animation.current=void 0),n}function h(e,t,r){if(P(e,t,r)){if(b(e,t,r)){var o=B.stop();y(e);var i={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:o};return n(e.movable.events.after,t,r,i),!0}}else T(e,t,r)?(c(e,t,r,{ctrlKey:e.stats.ctrlKey}),y(e)):k(e,r)||M(e,r)?(w(e,r),B.start()):y(e);return!1}function m(e,t,r,o){if(C(e,t,r)||o){var i=e.pieces[t];delete e.pieces[t],v(e,i,r,o),n(e.movable.events.afterNewPiece,i.role,r,{predrop:!1})}else x(e,t,r)?l(e,e.pieces[t].role,r):(u(e),d(e));delete e.pieces[t],y(e)}function g(e,t,r){e.selected?e.selected!==t||e.draggable.enabled?(e.selectable.enabled||r)&&e.selected!==t?h(e,e.selected,t)&&(e.stats.dragged=!1):B.start():(y(e),B.cancel()):(k(e,t)||M(e,t))&&(w(e,t),B.start()),t&&n(e.events.select,t)}function w(e,t){e.selected=t,M(e,t)?e.premovable.dests=q.default(e.pieces,t,e.premovable.castle):e.premovable.dests=void 0}function y(e){e.selected=void 0,e.premovable.dests=void 0,B.cancel()}function k(e,t){var r=e.pieces[t];return r&&("both"===e.movable.color||e.movable.color===r.color&&e.turnColor===r.color)}function P(e,t,r){return t!==r&&k(e,t)&&(e.movable.free||!!e.movable.dests&&S.containsX(e.movable.dests[t],r))}function C(e,t,r){var n=e.pieces[t];return n&&r&&(t===r||!e.pieces[r])&&("both"===e.movable.color||e.movable.color===n.color&&e.turnColor===n.color)}function M(e,t){var r=e.pieces[t];return r&&e.premovable.enabled&&e.movable.color===r.color&&e.turnColor!==r.color}function T(e,t,r){return t!==r&&M(e,t)&&S.containsX(q.default(e.pieces,t,e.premovable.castle),r)}function x(e,t,r){var n=e.pieces[t];return n&&r&&(!e.pieces[r]||e.pieces[r].color!==e.movable.color)&&e.predroppable.enabled&&("pawn"!==n.role||"1"!==r[1]&&"8"!==r[1])&&e.movable.color===n.color&&e.turnColor!==n.color}function O(e,t){var r=e.pieces[t];return r&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===r.color&&(e.turnColor===r.color||e.premovable.enabled))}function _(e){var t=e.premovable.current;if(!t)return!1;var r=t[0],o=t[1],i=!1;if(P(e,r,o)&&b(e,r,o)){var a={premove:!0};n(e.movable.events.after,r,o,a),i=!0}return u(e),i}function E(e,t){var r=e.predroppable.current,o=!1;if(!r)return!1;if(t(r)){var i={role:r.role,color:e.movable.color};v(e,i,r.key)&&(n(e.movable.events.afterNewPiece,r.role,r.key,{predrop:!0}),o=!0)}return d(e),o}function K(e){u(e),d(e),y(e)}function D(e){e.movable.color=void 0,e.movable.dests=void 0,K(e)}function j(e,t){var r=Math.ceil(8*((t[0]-e.dom.bounds.left)/e.dom.bounds.width));r="white"===e.orientation?r:9-r;var n=Math.ceil(8-8*((t[1]-e.dom.bounds.top)/e.dom.bounds.height));return n="white"===e.orientation?n:9-n,r>0&&r<9&&n>0&&n<9?S.pos2key([r,n]):void 0}function N(e){var t,r,n,o={king:0,queen:0,rook:0,bishop:0,knight:0,pawn:0};for(var i in e.pieces)t=e.pieces[i],o[t.role]+="white"===t.color?1:-1;var a={white:{},black:{}};for(r in o)n=o[r],n>0?a.white[r]=n:n<0&&(a.black[r]=-n);return a}function A(e){var t=0;for(var r in e.pieces)t+=L[e.pieces[r].role]*("white"===e.pieces[r].color?1:-1);return t}Object.defineProperty(r,"__esModule",{value:!0});var S=e("./util"),q=e("./premove"),B=e("./hold");r.toggleOrientation=o,r.reset=i,r.setPieces=a,r.setCheck=s,r.unsetPremove=u,r.unsetPredrop=d,r.baseMove=p,r.baseNewPiece=v,r.userMove=h,r.dropNewPiece=m,r.selectSquare=g,r.setSelected=w,r.unselect=y,r.isDraggable=O,r.playPremove=_,r.playPredrop=E,r.cancelMove=K,r.stop=D,r.getKeyAtDomPos=j,r.getMaterialDiff=N;var L={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:0};r.getScore=A},{"./hold":11,"./premove":13,"./util":18}],4:[function(e,t,r){"use strict";function n(e,t){function r(){var t=(n.dom?n.dom.elements.board:e).getBoundingClientRect(),r=s.default(n,t),o=r[0],i=r[1];e.innerHTML="",e.appendChild(o),n.dom={elements:i,bounds:t,redraw:function(e){void 0===e&&(e=!0),u.default(n),e&&i.svg&&l.default(n,i.svg)}},n.dom.redraw(),c.default(n)}var n=a.defaults();i.configure(n,t||{}),n.browser={transform:d.transformFunction()},r();var f=o.start(n,r);return f}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./api"),i=e("./config"),a=e("./state"),s=e("./wrap"),c=e("./events"),u=e("./render"),l=e("./svg"),d=e("./util");r.Chessground=n},{"./api":2,"./config":5,"./events":8,"./render":14,"./state":15,"./svg":16,"./util":18,"./wrap":19}],5:[function(e,t,r){"use strict";function n(e,t){t.movable&&t.movable.dests&&(e.movable.dests=void 0);var r=t.check;if(delete t.check,o(e,t),t.fen&&(e.pieces=s.read(t.fen),e.drawable.shapes=[]),void 0!==r&&a.setCheck(e,r),e.selected&&a.setSelected(e,e.selected),(!e.animation.duration||e.animation.duration<40)&&(e.animation.enabled=!1),!e.movable.rookCastle&&e.movable.dests){var n="white"===e.movable.color?1:8,i="e"+n,c=e.movable.dests[i];if(!c||"king"!==e.pieces[i].role)return;e.movable.dests[i]=c.filter(function(e){return(e!=="a"+n||c.indexOf("c"+n)===-1)&&(e!=="h"+n||c.indexOf("g"+n)===-1)})}}function o(e,t){for(var r in t)i(e[r])&&i(t[r])?o(e[r],t[r]):e[r]=t[r]}function i(e){return"object"==typeof e}Object.defineProperty(r,"__esModule",{value:!0});var a=e("./board"),s=e("./fen");r.configure=n},{"./board":3,"./fen":10}],6:[function(e,t,r){"use strict";function n(e,t){if(!(void 0!==t.button&&0!==t.button||t.touches&&t.touches.length>1)){t.stopPropagation(),t.preventDefault();var r=f.eventPosition(t),n=d.getKeyAtDomPos(e,r);if(n){var i=e.pieces[n],a=e.selected;if(a||!e.drawable.eraseOnClick&&i&&i.color===e.turnColor||p.clear(e),!e.viewOnly){var s=!!e.premovable.current,c=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,d.selectSquare(e,n);var v=e.selected===n,b=l(e,n);if(i&&b&&v&&d.isDraggable(e,n)){var h=u(e,n);e.draggable.current={orig:n,origPos:f.key2pos(n),piece:i,rel:r,epos:r,pos:[0,0],dec:e.draggable.centerPiece?[r[0]-(h.left+h.width/2),r[1]-(h.top+h.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged,element:b,previouslySelected:a,originTarget:t.target},b.cgDragging=!0,b.classList.add("dragging");var m=e.dom.elements.ghost;if(m){m.className="ghost "+i.color+" "+i.role;var g=f.posToTranslate(f.key2pos(n),"white"===e.orientation,e.dom.bounds);e.browser.transform(m,f.translate(g))}}else s&&d.unsetPremove(e),c&&d.unsetPredrop(e);f.raf(e.dom.redraw),o(e)}}}}function o(e){f.raf(function(){var t=e.draggable.current;if(t){if(e.animation.current&&e.animation.current.plan.anims[t.orig]&&(e.animation.current=void 0),e.pieces[t.orig]!==t.piece)s(e);else if(!t.started&&f.distance(t.epos,t.rel)>=e.draggable.distance&&(t.started=!0),t.started){t.pos=[t.epos[0]-t.rel[0],t.epos[1]-t.rel[1]],t.over=d.getKeyAtDomPos(e,t.epos);var r=f.posToTranslate(t.origPos,"white"===e.orientation,e.dom.bounds);r[0]+=t.pos[0]+t.dec[0],r[1]+=t.pos[1]+t.dec[1],e.browser.transform(t.element,f.translate(r));var n=e.dom.elements.over;if(n&&t.over&&t.over!==t.overPrev){var i=e.movable.dests;if(e.movable.free||f.containsX(i&&i[t.orig],t.over)||f.containsX(e.premovable.dests,t.over)){var a=e.dom.bounds.width/8,c=f.key2pos(t.over),u="white"===e.orientation,l=[(u?c[0]-1:8-c[0])*a,(u?8-c[1]:c[1]-1)*a];e.browser.transform(n,f.translate(l))}else e.browser.transform(n,f.translateAway);t.overPrev=t.over}}o(e)}})}function i(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.epos=f.eventPosition(t))}function a(e,t){var r=e.draggable.current;if(r||e.editable.enabled&&"pointer"!==e.editable.selected){if("touchend"===t.type&&r&&r.originTarget!==t.target&&!r.newPiece)return void(e.draggable.current=void 0);d.unsetPremove(e),d.unsetPredrop(e);var n=f.eventPosition(t),o=d.getKeyAtDomPos(e,n);if(o)if(e.editable.enabled&&"pointer"!==e.editable.selected)if("trash"===e.editable.selected)delete e.pieces[o],f.raf(e.dom.redraw);else{var i="a0";e.pieces[i]=e.editable.selected,d.dropNewPiece(e,i,o,!0)}else r&&r.started&&(r.newPiece?d.dropNewPiece(e,r.orig,o):(e.stats.ctrlKey=t.ctrlKey,d.userMove(e,r.orig,o)&&(e.stats.dragged=!0)));!r||r.orig!==r.previouslySelected||r.orig!==o&&o?e.selectable.enabled||d.unselect(e):d.unselect(e),c(e),e.draggable.current=void 0,f.raf(e.dom.redraw)}}function s(e){e.draggable.current&&(e.draggable.current=void 0,d.unselect(e),c(e))}function c(e){var t=e.dom.elements;t.over&&e.browser.transform(t.over,f.translateAway),t.ghost&&e.browser.transform(t.ghost,f.translateAway)}function u(e,t){var r=f.key2pos(t),n=e.dom.bounds;return"white"!==e.orientation&&(r[0]=9-r[0],r[1]=9-r[1]),{left:n.left+n.width*(r[0]-1)/8,top:n.top+n.height*(8-r[1])/8,width:n.width/8,height:n.height/8}}function l(e,t){for(var r=e.dom.elements.board.firstChild;r;){if(r.cgKey===t&&"PIECE"===r.tagName)return r;r=r.nextSibling}}Object.defineProperty(r,"__esModule",{value:!0});var d=e("./board"),f=e("./util"),p=e("./draw");r.start=n,r.move=i,r.end=a,r.cancel=s},{"./board":3,"./draw":7,"./util":18}],7:[function(e,t,r){"use strict";function n(e,t){if(!(t.touches&&t.touches.length>1)){t.stopPropagation(),t.preventDefault(),v.cancelMove(e);var r=b.eventPosition(t),n=v.getKeyAtDomPos(e,r);n&&(e.drawable.current={orig:n,dest:n,pos:r,brush:u(t)},o(e))}}function o(e){b.raf(function(){var t=e.drawable.current;if(t){var r=v.getKeyAtDomPos(e,t.pos),n=t.orig===r?void 0:r;n!==t.dest&&(t.dest=n,e.dom.redraw())}t&&o(e)})}function i(e,t){e.drawable.current&&(e.drawable.current.pos=b.eventPosition(t))}function a(e){var t=e.drawable.current;t&&(t.dest?f(e.drawable,t,t.dest):d(e.drawable,t),e.drawable.current=void 0,e.dom.redraw())}function s(e){e.drawable.current&&(e.drawable.current=void 0)}function c(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),p(e.drawable))}function u(e){var t=e.shiftKey&&b.isRightButton(e)?1:0,r=e.altKey?2:0;return h[t+r]}function l(e){return function(t){return!e(t)}}function d(e,t){var r=t.orig,n=function(e){return e.orig===r&&!e.dest},o=e.shapes.filter(n)[0];o&&(e.shapes=e.shapes.filter(l(n))),o&&o.brush===t.brush||e.shapes.push({brush:t.brush,orig:r}),p(e)}function f(e,t,r){var n=t.orig,o=function(e){return!!e.dest&&(e.orig===n&&e.dest===r||e.dest===n&&e.orig===r)},i=e.shapes.filter(o).length>0;i?e.shapes=e.shapes.filter(l(o)):e.shapes.push({brush:t.brush,orig:n,dest:r}),p(e)}function p(e){e.onChange&&e.onChange(e.shapes)}Object.defineProperty(r,"__esModule",{value:!0});var v=e("./board"),b=e("./util"),h=["green","red","blue","yellow"];r.start=n,r.processDraw=o,r.move=i,r.end=a,r.cancel=s,r.clear=c},{"./board":3,"./util":18}],8:[function(e,t,r){"use strict";function n(e){var t,r,n,p=o(e),v=i(e,s.move,c.move),b=i(e,s.end,c.end);e.editable.enabled?(t=function(t){"pointer"===e.editable.selected?"mousemove"!==t.type&&p(t):("mousemove"!==t.type||u.isLeftButton(t))&&b(t)},r=function(t){"pointer"===e.editable.selected&&v(t)},n=function(t){"pointer"===e.editable.selected&&b(t)},l.push("mousemove")):(t=p,r=v,n=b),l.forEach(function(r){return e.dom.elements.board.addEventListener(r,t)}),d.forEach(function(e){return document.addEventListener(e,r)}),f.forEach(function(e){return document.addEventListener(e,n)}),a(e);var h=function(t){return!e.disableContextMenu&&!e.drawable.enabled||(t.preventDefault(),!1)};e.dom.elements.board.addEventListener("contextmenu",h)}function o(e){return function(t){u.isRightButton(t)&&e.draggable.current?(e.draggable.current.newPiece&&delete e.pieces[e.draggable.current.orig],e.draggable.current=void 0,e.selected=void 0):(t.shiftKey||u.isRightButton(t))&&e.drawable.enabled?c.start(e,t):s.start(e,t)}}function i(e,t,r){return function(n){(n.shiftKey||u.isRightButton(n))&&e.drawable.enabled?r(e,n):e.viewOnly||t(e,n)}}function a(e){function t(){e.dom.bounds=e.dom.elements.board.getBoundingClientRect(),e.dom.redraw()}e.resizable&&(["onscroll","onresize"].forEach(function(e){var r=window[e];window[e]=function(e){r&&r.apply(window,e),t()}}),document.body.addEventListener("chessground.resize",t,!1))}Object.defineProperty(r,"__esModule",{value:!0});var s=e("./drag"),c=e("./draw"),u=e("./util"),l=["touchstart","mousedown"],d=["touchmove","mousemove"],f=["touchend","mouseup"];r.default=n},{"./drag":6,"./draw":7,"./util":18}],9:[function(e,t,r){"use strict";function n(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(function(){o(e,2),setTimeout(function(){return o(e,void 0)},120)},120)}function o(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],10:[function(e,t,r){"use strict";function n(e){"start"===e&&(e=r.initial);var t,n,o,a={};return e.replace(u,"").replace(l,"").split("/").forEach(function(e,r){t=0,e.split("").forEach(function(e){n=parseInt(e),n?t+=n:(++t,o=e.toLowerCase(),a[i.pos2key([t,8-r])]={role:s[o],color:e===o?"black":"white"})})}),a}function o(e){var t,r;return[8,7,6,5,4,3,2].reduce(function(e,t){return e.replace(new RegExp(Array(t+1).join("1"),"g"),t)},i.invRanks.map(function(n){return a.ranks.map(function(o){return t=e[i.pos2key([o,n])],t?(r=c[t.role],"white"===t.color?r.toUpperCase():r):"1"}).join("")}).join("/"))}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./util"),a=e("./types");r.initial="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";var s={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},c={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"},u=/ .+$/,l=/~/g;r.read=n,r.write=o},{"./types":17,"./util":18}],11:[function(e,t,r){"use strict";function n(){a=new Date}function o(){a=void 0}function i(){if(!a)return 0;var e=(new Date).getTime()-a.getTime();return a=void 0,e}Object.defineProperty(r,"__esModule",{value:!0});var a;r.start=n,r.cancel=o,r.stop=i},{}],12:[function(e,t,r){t.exports=e("./chessground").Chessground},{"./chessground":4}],13:[function(e,t,r){"use strict";function n(e,t){return Math.abs(e-t)}function o(e){return function(t,r,o,i){return n(t,o)<2&&("white"===e?i===r+1||r<=2&&i===r+2&&t===o:i===r-1||r>=7&&i===r-2&&t===o)}}function i(e,t,r){return function(o,i,a,s){return n(o,a)<2&&n(i,s)<2||r&&i===s&&i===("white"===e?1:8)&&(5===o&&(3===a||7===a)||c.containsX(t,a))}}function a(e,t){var r;return Object.keys(e).filter(function(n){return r=e[n],r&&r.color===t&&"rook"===r.role}).map(function(e){return c.key2pos(e)[0]})}function s(e,t,r){var n,s=e[t],p=c.key2pos(t);switch(s.role){case"pawn":n=o(s.color);break;case"knight":n=u;break;case"bishop":n=l;break;case"rook":n=d;break;case"queen":n=f;break;case"king":n=i(s.color,a(e,s.color),r)}return c.allPos.filter(function(e){return(p[0]!==e[0]||p[1]!==e[1])&&n(p[0],p[1],e[0],e[1])}).map(c.pos2key)}Object.defineProperty(r,"__esModule",{value:!0});var c=e("./util"),u=function(e,t,r,o){var i=n(e,r),a=n(t,o);return 1===i&&2===a||2===i&&1===a},l=function(e,t,r,o){return n(e,r)===n(t,o)},d=function(e,t,r,n){return e===r||t===n},f=function(e,t,r,n){return l(e,t,r,n)||d(e,t,r,n)};r.default=s},{"./util":18}],14:[function(e,t,r){"use strict";function n(e){var t,r,n,f,v,b,h,m,g,w,y,k,P,C="white"===e.orientation,M=e.dom.bounds,T=e.dom.elements.board,x=e.pieces,O=e.animation.current,_=O?O.plan.anims:{},E=O?O.plan.fadings:{},K=e.draggable.current,D=d(e),j={},N={},A={},S={},q=Object.keys(x),B=e.browser.transform;for(n=T.firstChild;n;){if(t=n.cgKey,f=D[t],v=x[t],m=_[t],g=E[t],o(n))b=n.cgPiece,!n.cgDragging||K&&K.orig===t||(n.classList.remove("dragging"),B(n,p.translate(p.posToTranslate(p.key2pos(t),C,M))),n.cgDragging=!1),!g&&n.cgFading&&(n.cgFading=!1,n.classList.remove("fading")),v?(m&&n.cgAnimating&&b===l(v)?(h=p.posToTranslate(p.key2pos(t),C,M),h[0]+=m[1][0],h[1]+=m[1][1],B(n,p.translate(h))):n.cgAnimating&&(h=p.posToTranslate(p.key2pos(t),C,M),B(n,p.translate(h)),n.cgAnimating=!1),b===l(v)?j[t]=!0:g&&b===l(g)?(n.classList.add("fading"),n.cgFading=!0):A[b]?A[b].push(n):A[b]=[n]):A[b]?A[b].push(n):A[b]=[n];else if(i(n)){var L=n.className;f===L?N[t]=!0:S[L]?S[L].push(n):S[L]=[n]}n=n.nextSibling}for(var W in D)N[W]||(k=S[D[W]],P=k&&k.pop(),h=p.posToTranslate(p.key2pos(W),C,M),P?(P.cgKey=W,B(P,p.translate(h))):T.insertBefore(s(W,D[W],h,B),T.firstChild));for(var R in q)if(t=q[R],r=x[t],m=_[t],!j[t])if(w=A[l(r)],y=w&&w.pop()){y.cgKey=t;var I=p.key2pos(t);e.addPieceZIndex&&(y.style.zIndex=u(I,C)),h=p.posToTranslate(I,C,M),m&&(y.cgAnimating=!0,h[0]+=m[1][0],h[1]+=m[1][1]),B(y,p.translate(h))}else T.appendChild(c(e,r,t,C,m));for(var X in A)a(e,A[X]);for(var X in S)a(e,S[X])}function o(e){return"PIECE"===e.tagName}function i(e){return"SQUARE"===e.tagName}function a(e,t){for(var r in t)e.dom.elements.board.removeChild(t[r])}function s(e,t,r,n){var o=document.createElement("square");return o.className=t,o.cgKey=e,n(o,p.translate(r)),o}function c(e,t,r,n,o){var i=document.createElement("piece"),a=l(t),s=p.key2pos(r);i.className=a,i.cgPiece=a,i.cgKey=r;var c=p.posToTranslate(s,n,e.dom.bounds);return o&&(i.cgAnimating=!0,c[0]+=o[1][0],c[1]+=o[1][1]),e.browser.transform(i,p.translate(c)),e.addPieceZIndex&&(i.style.zIndex=u(s,n)),i}function u(e,t){var r=2+8*(e[1]-1)+(8-e[0]);return t&&(r=67-r),r+""}function l(e){return e.color+" "+e.role}function d(e){var t,r,n={};if(e.lastMove&&e.highlight.lastMove)for(t in e.lastMove)f(n,e.lastMove[t],"last-move");if(e.check&&e.highlight.check&&f(n,e.check,"check"),e.selected&&(f(n,e.selected,"selected"),e.movable.showDests)){var o=e.movable.dests&&e.movable.dests[e.selected];if(o)for(t in o)r=o[t],f(n,r,"move-dest"+(e.pieces[r]?" oc":""));var i=e.premovable.dests;if(i)for(t in i)r=i[t],f(n,r,"premove-dest"+(e.pieces[r]?" oc":""))}var a=e.premovable.current;if(a)for(t in a)f(n,a[t],"current-premove");else e.predroppable.current&&f(n,e.predroppable.current.key,"current-premove");var s=e.exploding;if(s)for(t in s.keys)f(n,s.keys[t],"exploding"+s.stage);return n}function f(e,t,r){e[t]?e[t]+=" "+r:e[t]=r}Object.defineProperty(r,"__esModule",{value:!0});var p=e("./util");r.default=n},{"./util":18}],15:[function(e,t,r){"use strict";function n(){return{pieces:o.read(o.initial),orientation:"white",turnColor:"white",coordinates:!0,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,resizable:!0,addPieceZIndex:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",dropOff:"revert",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://lichess1.org/assets/piece/cburnett/"}},editable:{enabled:!1,selected:"pointer"}}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./fen");r.defaults=n},{"./fen":10}],16:[function(e,t,r){"use strict";function n(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function o(e,t){var r=e.drawable,n=t.firstChild,o=r.shapes.concat(r.autoShapes).map(function(e){return{shape:e,current:!1,hash:s(e,!1)}});r.current&&o.push({shape:r.current,current:!0,hash:s(r.current,!0)});var c=o.map(function(e){return e.hash}).join("");c!==T&&(T=c,i(r,o,n),a(e,o,r.brushes,t,n))}function i(e,t,r){var n,o={};t.forEach(function(t){t.shape.dest&&(n=e.brushes[t.shape.brush],t.shape.modifiers&&(n=m(n,t.shape.modifiers)),o[n.key]=n)});for(var i={},a=r.firstChild;a;)i[a.getAttribute("cgKey")]=!0,a=a.nextSibling;for(var s in o)i[s]||r.appendChild(v(o[s]))}function a(e,t,r,n,o){void 0===M&&(M=C.computeIsTrident());var i={},a=[];t.forEach(function(e){i[e.hash]=!1});for(var s,c=o.nextSibling;c;)s=c.getAttribute("cgHash"),i.hasOwnProperty(s)?i[s]=!0:a.push(c),c=c.nextSibling;a.forEach(function(e){return n.removeChild(e)}),t.forEach(function(t){i[t.hash]||n.appendChild(l(e,t,r))})}function s(e,t){var r=e.orig,n=e.dest,o=e.brush,i=e.piece,a=e.modifiers;return[t,r,n,o,i&&c(i),a&&u(a)].filter(function(e){return e}).join("")}function c(e){return[e.color,e.role,e.scale].filter(function(e){return e}).join("")}function u(e){return""+(e.lineWidth||"")}function l(e,t,r){var n,o=t.shape,i=t.current,a=t.hash;if(o.piece)n=p(e.drawable.pieces.baseUrl,h(C.key2pos(o.orig),e.orientation),o.piece,e.dom.bounds);else{var s=h(C.key2pos(o.orig),e.orientation);if(o.orig&&o.dest){var c=r[o.brush];o.modifiers&&(c=m(c,o.modifiers)),n=f(e.dom,c,s,h(C.key2pos(o.dest),e.orientation),i)}else n=d(r[o.brush],s,i,e.dom.bounds)}return n.setAttribute("cgHash",a),n}function d(e,t,r,o){var i=P(t,o),a=g(r,o),s=o.width/16;return b(n("circle"),{stroke:e.color,"stroke-width":a,fill:"none",opacity:y(e,r),cx:i[0],cy:i[1],r:s-a/2})}function f(e,t,r,o,i){var a=k(e,i),s=P(r,e.bounds),c=P(o,e.bounds),u=c[0]-s[0],l=c[1]-s[1],d=Math.atan2(l,u),f=Math.cos(d)*a,p=Math.sin(d)*a;return b(n("line"),{stroke:t.color,"stroke-width":w(t,i,e.bounds),"stroke-linecap":"round","marker-end":M?void 0:"url(#arrowhead-"+t.key+")",opacity:y(t,i),x1:s[0],y1:s[1],x2:c[0]-f,y2:c[1]-p})}function p(e,t,r,o){var i=P(t,o),a=o.width/8*(r.scale||1),s=r.color[0]+("knight"===r.role?"n":r.role[0]).toUpperCase();return b(n("image"),{className:r.role+" "+r.color,x:i[0]-a/2,y:i[1]-a/2,width:a,height:a,href:e+s+".svg"})}function v(e){var t=b(n("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(b(n("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function b(e,t){for(var r in t)e.setAttribute(r,t[r]);return e}function h(e,t){return"white"===t?e:[9-e[0],9-e[1]]}function m(e,t){var r={color:e.color,opacity:Math.round(10*e.opacity)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth)};return r.key=[e.key,t.lineWidth].filter(function(e){return e}).join(""),r}function g(e,t){return(e?3:4)/512*t.width}function w(e,t,r){return(e.lineWidth||10)*(t?.85:1)/512*r.width}function y(e,t){return(e.opacity||1)*(t?.9:1)}function k(e,t){return M?0:(t?10:20)/512*e.bounds.width}function P(e,t){var r=t.width/8;return[(e[0]-.5)*r,(8.5-e[1])*r]}Object.defineProperty(r,"__esModule",{value:!0});var C=e("./util");r.createElement=n;var M,T="";r.default=o},{"./util":18}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.files=["a","b","c","d","e","f","g","h"],r.ranks=[1,2,3,4,5,6,7,8]},{}],18:[function(e,t,r){"use strict";function n(e){return h.files[e[0]-1]+e[1]}function o(e){return[r.fileNumbers[e[0]],parseInt(e[1])]}function i(e){return h.files[8-r.fileNumbers[e[0]]]+(9-parseInt(e[1]))}function a(e){return"white"===e?"black":"white"}function s(e,t){return!!e&&e.indexOf(t)!==-1}function c(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function u(){var e=document.body.style,t="transform"in e?"transform":"webkitTransform"in e?"webkitTransform":"mozTransform"in e?"mozTransform":"oTransform"in e?"oTransform":"msTransform";return function(e,r){return e.style.setProperty(t,r)}}function l(){return window.navigator.userAgent.indexOf("Trident/")>-1}function d(e,t,r){return[(t?e[0]-1:8-e[0])*r.width/8,(t?8-e[1]:e[1]-1)*r.height/8]}function f(e){return"translate("+e[0]+"px,"+e[1]+"px)"}function p(e){if(e.clientX||0===e.clientX)return[e.clientX,e.clientY];if(e.touches&&e.targetTouches[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY];throw"Cannot find position of event "+e}function v(e){return 1===e.buttons||1===e.button}function b(e){return 2===e.buttons||2===e.button}Object.defineProperty(r,"__esModule",{value:!0});var h=e("./types");r.invRanks=[8,7,6,5,4,3,2,1],r.fileNumbers={a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8},r.pos2key=n,r.key2pos=o,r.invertKey=i,r.allPos=[],r.allKeys=[],r.invKeys=[];var m,g,w,y;for(y=8;y>0;--y)for(w=1;w<9;++w)m=[w,y],g=n(m),r.allPos.push(m),r.allKeys.push(g),r.invKeys.unshift(g);r.opposite=a,r.containsX=s,r.distance=c,r.transformFunction=u,r.computeIsTrident=l,r.posToTranslate=d,r.translate=f,r.translateAway=f([-99999,-99999]),r.eventPosition=p,r.isLeftButton=v,r.isRightButton=b,r.raf=(window.requestAnimationFrame||window.setTimeout).bind(window)},{"./types":17}],19:[function(e,t,r){"use strict";function n(e,t){var r=document.createElement("div"),n=e.viewOnly?"view-only":"manipulable";r.className="cg-board-wrap orientation-"+e.orientation+" "+n;var a=document.createElement("div");a.className="cg-board",r.appendChild(a);var u;if(e.drawable.enabled&&(u=c.createElement("svg"),u.appendChild(c.createElement("defs")),r.appendChild(u)),e.coordinates){var l="black"===e.orientation?" black":"";r.appendChild(i(s.ranks,"ranks"+l)),r.appendChild(i(s.files,"files"+l))}var d;e.viewOnly||!e.movable.showDests&&!e.premovable.showDests||(d=o(e.browser,t,"div","over"),r.appendChild(d));var f;return!e.viewOnly&&e.draggable.showGhost&&(f=o(e.browser,t,"piece","ghost"),r.appendChild(f)),[r,{board:a,over:d,ghost:f,svg:u}]}function o(e,t,r,n){var o=t.width/8,i=document.createElement(r);return i.className=n,i.style.width=o+"px",i.style.height=o+"px",e.transform(i,a.translateAway),i}function i(e,t){var r=document.createElement("coords");r.className=t;var n;for(var o in e)n=document.createElement("coord"),n.textContent=e[o],r.appendChild(n);return r}Object.defineProperty(r,"__esModule",{value:!0});var a=e("./util"),s=e("./types"),c=e("./svg");r.default=n},{"./svg":16,"./types":17,"./util":18}]},{},[12])(12)});