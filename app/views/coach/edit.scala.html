@(c: lila.coach.Coach.WithUser, form: Form[_], reviews: lila.coach.CoachReview.Reviews)(implicit ctx: Context)

@import play.api.data.Field

@moreJs = {
@jsAt("vendor/jquery.form.min.js")
@jsAt("vendor/bar-rating/dist/jquery.barrating.min.js")
@jsTag("coach.form.js")
}

@side = {
<a href="@routes.Coach.show(c.user.username)" class="preview button text" data-icon="v">Preview coach page</a>
}

@base.layout(title = s"${c.user.titleUsername} coach page",
moreCss = cssTags("form3.css", "coach.form.css"),
moreJs = moreJs,
side = side.some) {
<div class="coach_edit content_box no_padding">
  <div class="top">
    <div class="picture_wrap">
      @if(c.coach.hasPicture) {
      <a class="upload_picture" href="@routes.Coach.picture" title="Change/delete your profile picture">
        @pic(c, 250)
      </a>
      } else {
      <div class="upload_picture">
        <a class="button" href="@routes.Coach.picture">Upload a profile picture</a>
      </div>
      }
    </div>
    <div class="overview">
      <h1>
        @c.user.title.map { t => @t }@c.user.profileOrDefault.nonEmptyRealName.getOrElse(c.user.username)
      </h1>
      <div class="todo" data-profile="@c.user.profileOrDefault.isComplete">
        <h3>TODO list before publishing your coach profile</h3>
        <ul></ul>
      </div>
    </div>
  </div>
  <form class="content_box_content form3" action="@routes.Coach.edit" method="POST">
    <div class="tabs">
      <div data-tab="basics" class="active">Basics</div>
      <div data-tab="texts">Texts</div>
      <div data-tab="contents">Contents</div>
      <div data-tab="reviews" data-count="@reviews.list.size" class="data-count">
        Pending reviews
      </div>
    </div>
    <div class="panels">
      <div class="panel basics active">
        @form3.split {
          @form3.checkbox(form("listed"), Html("Publish on the coaches list"), help = Html("Enable when your profile is ready").some, half = true)
          @form3.checkbox(form("available"), Html("Currently available for lessons"), help = Html("Enable to get more students").some, half = true)
          }
        @form3.group(form("profile.headline"), Html("Short and inspiring headline"), help = Html("Just one sentence to make students want to choose you").some)(form3.input(_, maxLength = 170))
        @form3.split {
          @form3.group(form("profile.languages"), Html("Languages spoken"), help = Html("Which languages can you give lessons in?").some, half = true)(form3.input(_, maxLength = 140))
          @form3.group(form("profile.hourlyRate"), Html("Hourly rate"), help = Html("Indicative, non-contractual").some, half = true)(form3.input(_, maxLength = 140))
          }
      </div>
      <div class="panel texts">
        @form3.group(form("profile.description"), Html("Who are you?"), help = Html("Age, profession, country... let your students know you").some)(form3.textarea(_, rows = 8.some))
        @form3.group(form("profile.playingExperience"), Html("Playing experience"), help = Html("Tournaments played, best wins, other achievements").some)(form3.textarea(_, rows = 8.some))
        @form3.group(form("profile.teachingExperience"), Html("Teaching experience"), help = Html("Diplomas, years of practice, best student results").some)(form3.textarea(_, rows = 8.some))
        @form3.group(form("profile.otherExperience"), Html("Other experiences"), help = Html("E.g. as chess commentator, or teaching other domains").some)(form3.textarea(_, rows = 8.some))
        @form3.group(form("profile.skills"), Html("Best skills in chess and teaching"))(form3.textarea(_, rows = 8.some))
        @form3.group(form("profile.methodology"), Html("Teaching methodology"), help = Html("How you prepare and run lessons. How you follow up with students.").some)(form3.textarea(_, rows = 8.some))
      </div>
      <div class="panel contents">
        @form3.group(form("profile.publicStudies"), Html("Featured public lichess studies"), help = Html("Up to 6 lichess study URLs, one per line").some)(form3.textarea(_))
        @form3.group(form("profile.youtubeChannel"), Html("URL of your Youtube channel"))(form3.input(_))
        @form3.group(form("profile.youtubeVideos"), Html("Featured youtube videos"), help = Html("Up to 6 Youtube video URLs, one per line").some)(form3.textarea(_, rows = 6.some))
      </div>
      <div class="panel reviews">
        <p class="help text" data-icon="î€…">Reviews are visible only after you approve them.</p>
        @reviews.list.map { r =>
        <div class="review" data-action="@routes.Coach.approveReview(r.id)">
          <div class="user">
            @userIdLink(r.userId.some)
            @barRating(selected = r.score.some, enabled = false)
            @momentFromNow(r.updatedAt)
          </div>
          <div class="content">
            @if(r.moddedAt.isDefined) {
            <div class="modded">
              Moderators have disapproved this review. Please only accept reviews from
              actual students, based on actual lessons. Reviews must be about your coaching services.
              <br />
              You may delete this review, or ask the author to rephrase it, then approve it.
            </div>
            }
            @richText(r.text)
          </div>
          <div class="actions">
            @if(r.moddedAt.fold(true)(_.isBefore(r.updatedAt))) {
            <a data-value="1" class="yes" data-icon="E"></a>
            }
            <a data-value="0" class="no" data-icon="L"></a>
          </div>
        </div>
        }
      </div>
    </div>
    <div class="status text" data-icon="E">Your changes have been saved.</div>
  </form>
</div>
}
