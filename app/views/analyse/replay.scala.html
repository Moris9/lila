@(pov: Pov, roomHtml: Html, bookmarkers: List[User], opening: Option[chess.OpeningExplorer.Opening])(implicit ctx: Context)

@import pov._

@moreCss = {
@cssTag("analyse.css")
}

@moreJs = {
@jsVendorTag("pgn4web/pgn4web.js")
@jsTag("analyse.js")
}

@underchat = {
@trans.opening() -
@opening.map { o =>
<a href="http://www.chessgames.com/perl/chessopening?eco=@o.code">@o.code @o.name</a><br />
}.getOrElse { "Unknown" }
<a class="rotate_board" href="@routes.Analyse.replay(gameId, (!color).name)">@trans.flipBoard()</a><br />
<br />
<a href="@routes.Analyse.pgn(game.id)">Download PGN</a>
@if(bookmarkers.nonEmpty) {
<div class="bookmarkers">
  <p>@trans.bookmarkedByNbPlayers(bookmarkers.size)</p>
  <ul>
    @bookmarkers.map { bookmarker =>
    <li>@userLink(bookmarker)</li>
    }
  </ul>
</div>
}
<textarea id="pgnText" readonly="readonly">@Html(game.pgn)</textarea>
}

@analyse.layout(
title = trans.replayAndAnalyse() + " " + gameId,
goodies = round.watcherGoodies(pov).some,
chat = round.room(roomHtml, true).some,
underchat = underchat.some,
moreCss = moreCss,
moreJs = moreJs) {
<div class="analyse clearfix">
  <div class="board_wrap">
    <div id="GameBoard" class="colorable_board @color.fold("", " flip")"></div>
    <div id="GameButtons"></div>
  </div>
  <div class="moves_wrap">
    <h1>@trans.replayAndAnalyse()</h1>
    <div id="GameText"></div>
  </div>
</div>
@round.share(game)
}
